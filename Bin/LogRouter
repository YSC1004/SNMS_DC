#!/usr/bin/env python3
import sys
import os
import time

# -------------------------------------------------------
# 1. 프로젝트 경로 설정
# -------------------------------------------------------
# 현재 스크립트 위치(Bin/)의 상위 디렉토리를 프로젝트 루트로 설정
current_dir = os.path.dirname(os.path.abspath(__file__))
project_root = os.path.abspath(os.path.join(current_dir, '..'))
if project_root not in sys.path:
    sys.path.append(project_root)

# -------------------------------------------------------
# 2. 메인 모듈 임포트
# -------------------------------------------------------
try:
    # LogRouterWorld가 위치한 경로 (Server 패키지)
    from Class.ProcLogRouter.LogRouterWorld import LogRouterWorld
except ImportError as e:
    print(f"[Error] Failed to import LogRouterWorld: {e}")
    sys.exit(1)

def main():
    # -------------------------------------------------------
    # 3. LogRouter 인스턴스 생성 및 초기화
    # -------------------------------------------------------
    # C++: LogRouterWorld* world = new LogRouterWorld();
    world = LogRouterWorld()
    
    # C++: world->AppStart(argc, argv);
    if not world.app_start(len(sys.argv), sys.argv):
        print("[Error] Failed to start LogRouterWorld.")
        sys.exit(1)

    print(f"[Info] LogRouter Started (PID: {os.getpid()})")

    # -------------------------------------------------------
    # 4. 메인 루프 (Main Loop)
    # -------------------------------------------------------
    try:
        while True:
            time.sleep(1)
    except KeyboardInterrupt:
        print("\n[Info] LogRouter stopping by KeyboardInterrupt...")
        pass
    except Exception as e:
        print(f"[Error] Runtime Exception: {e}")
        sys.exit(1)

if __name__ == "__main__":
    main()